# Trustworthy Hybrid Neural Diagnosis with Neuro-Symbolic AI

## Project Overview
This project implements a **Hybrid Neuro-Symbolic Diagnostic System** for medical diagnosis, specifically targeting Diabetes using the **CDC Diabetes Health Indicators Dataset**.

The core philosophy is **"Trustworthy AI"**: moving beyond "black box" neural networks by integrating them with transparent, classical AI methods. The system combines:
1.  **Deep Learning:** A fixed-architecture Multi-Layer Perceptron (MLP) for high-accuracy classification.
2.  **Hyperparameter Optimization (HPO):** Rigorous optimization using Random Search, Bayesian Optimization (Optuna), and Evolutionary Algorithms (Genetic, Differential Evolution, Particle Swarm).
3.  **Neuro-Symbolic Interpretability:** A parallel "Expert Layer" consisting of:
    *   **Rule-Based Reasoning:** Explicit medical guidelines (IF-THEN).
    *   **Fuzzy Logic:** Nuanced risk scoring for continuous variables (BMI, Age).
    *   **Bayesian Inference:** Probabilistic sanity checks.
4.  **Unsupervised Analysis:** PCA and K-Means clustering to explore latent data structures.

---

## Repository Structure

### `src/` - Source Code
The core logic of the application.
*   **`data/`**: Data loading and preprocessing.
    *   `load_data.py`: Fetches CDC dataset, handles splitting and scaling.
    *   `outlier_detection.py`: Removes statistical outliers to clean training data.
*   **`models/`**: Neural Network definitions.
    *   `mlp_baseline.py`: PyTorch implementation of the MLP.
    *   `train.py`: Training loop with early stopping and logging.
    *   `evaluate.py`: Metrics calculation (ROC-AUC, F1, Confusion Matrix).
*   **`hpo/`**: Hyperparameter Optimization Algorithms.
    *   `grid_random_search.py`: Random & Grid Search implementations.
    *   `bayesian_opt.py`: Optuna integration for Bayesian optimization.
    *   `evolutionary_hpo.py`: Genetic Algorithm (GA).
    *   `differential_evolution.py`: Differential Evolution (DE).
    *   `particle_swarm_optimization.py`: Particle Swarm Optimization (PSO).
*   **`interpretability/`**: The "Symbolic Expert" layer.
    *   `rules.py`: Explicit IF-THEN medical rules.
    *   `fuzzy.py`: Fuzzy sets and inference logic.
    *   `bayesian_update.py`: Gaussian Naive Bayes for probabilistic updates.
*   **`analysis/`**: Post-training analysis scripts.
    *   `error_analysis.py`: Neuro-symbolic "Safety Net" analysis and hard-example detection.
    *   `feature_importance.py`: Permutation feature importance calculation.
    *   `plot_hpo.py`: Visualization of HPO convergence and distributions.
    *   `plot_evo_comparison.py`: Comparing GA, DE, and PSO convergence.
*   **`utils/`**: Helper functions.
    *   `visualization.py`: Plotting functions (PCA, K-Means, Confusion Matrix).
*   **`pipeline.py`**: **Main Entry Point.** Orchestrates the entire workflow.

### `experiments/` - Results & Artifacts
Stores outputs generated by the pipeline.
*   **`best_models/`**: Saved PyTorch model weights (`.pth`).
*   **`hpo_results/`**: JSON logs of all HPO trials.
*   **`*.png`**: All generated plots (see below).

### `paper/` - Scientific Report
*   `ijcnn_paper.tex`: The final IEEE/IJCNN-style research paper.
*   `references.bib`: Bibliography file.
*   `figures/`: Copies of plots used in the LaTeX report.

---

## Key Features & Functionalities

### 1. Automated Pipeline
Run the full experiment with a single command:
```bash
export PYTHONPATH=$PYTHONPATH:.
python3 src/pipeline.py
```
This will:
1.  Load and preprocess data.
2.  Train the Baseline MLP.
3.  Run Classical AI (Rules/Fuzzy/Bayes) on test samples.
4.  Perform Unsupervised Analysis (PCA, K-Means).
5.  (Optional) Trigger the full HPO suite.

### 2. Hyperparameter Optimization (HPO)
We support five distinct optimization strategies to find the best model architecture:
*   Random Search
*   Bayesian Optimization (Optuna) - *Fastest Convergence*
*   Genetic Algorithm (GA)
*   Differential Evolution (DE)
*   Particle Swarm Optimization (PSO)

**Convergence Comparison:**
![HPO Convergence](experiments/hpo_convergence.png)

### 3. Neuro-Symbolic "Safety Net"
The system doesn't just predict; it explains and audits.
*   **False Negative Catch:** If the neural net misses a diagnosis, the Rule-Based system acts as a safety net, correctly flagging **80%** of these missed cases as "High Risk".
*   **False Positive Correction:** If the neural net raises a false alarm, the Fuzzy Logic system corrects it **99%** of the time.

### 4. Explainability (XAI)
We analyze *what* the model learned.
*   **Feature Importance:** Confirms that the model relies on medically valid features like General Health, BMI, and Age.

**Feature Importance Plot:**
![Feature Importance](experiments/feature_importance.png)

### 5. Data Exploration
We visualize the high-dimensional medical data using PCA and Clustering.

**PCA Visualization:**
![PCA Labels](experiments/unsupervised_pca_labels.png)

---

## How to Reproduce
1.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **Run Pipeline:**
    ```bash
    python3 src/pipeline.py
    ```
3.  **Run Specific Analysis:**
    ```bash
    python3 src/analysis/error_analysis.py
    python3 src/analysis/feature_importance.py
    ```
